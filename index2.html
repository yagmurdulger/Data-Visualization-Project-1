<head>
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <style>
  
        .gridlines line {
          stroke: #bbb;
        }
        
        .gridlines .domain {
          stroke: none;
        }
      
    </style>
</head>

<body>
    <svg id="svg1" height="500" width="500" ></svg> <br><br><br><br><br>
    <svg id="svg2" height="500" width="500" ></svg><br><br><br><br><br>
    <svg id="svg3" height="500" width="500" ></svg><br><br><br><br><br>
    <svg id="svg4" height="500" width="500" ></svg><br><br><br><br><br>
    <svg id="svg5" height="500" width="500" ></svg><br><br><br><br><br>
    <svg id="svg6" height="500" width="500" ></svg><br><br><br><br><br>
    
    <script>
        d3.csv('./World Happiness Report 2022.csv')
        .then((data) => {
            console.log('this is data', data)

        const svg = d3.selectAll("svg")
        const svg1 = d3.select("svg#svg1")
        const svg2 = d3.select("svg#svg2")
        const svg3 = d3.select("svg#svg3")
        const svg4 = d3.select("svg#svg4")
        const svg5 = d3.select("svg#svg5")
        const svg6 = d3.select("svg#svg6")
        const width = svg.attr('width');
        const height = svg.attr('height');

        const margins = {top: 10, right: 10, bottom: 50, left: 50};
        const chartWidth = width - margins.left - margins.right;
        const chartHeight = height - margins.top - margins.bottom;

        let chartArea1 = svg1.append('g').attr('transform',`translate(${margins.left},${margins.top})`);
        let chartArea2 = svg2.append('g').attr('transform',`translate(${margins.left},${margins.top})`);    
        let chartArea3 = svg3.append('g').attr('transform',`translate(${margins.left},${margins.top})`);    
        let chartArea4 = svg4.append('g').attr('transform',`translate(${margins.left},${margins.top})`);    
        let chartArea5 = svg5.append('g').attr('transform',`translate(${margins.left},${margins.top})`);    
        let chartArea6 = svg6.append('g').attr('transform',`translate(${margins.left},${margins.top})`);    
                                    

        const GDPExtent = d3.extent(data, d => d['Explained by: GDP per capita'])
        const xScale1_GDP = d3.scaleLinear().domain(GDPExtent).range([0, chartHeight])

        const SocialSupportExtent = d3.extent(data, d => d['Explained by: Social support'])
        const xScale2_SocialSupport = d3.scaleLinear().domain(SocialSupportExtent).range([0, chartHeight])

        const HealthExtent = d3.extent(data, d => d['Explained by: Healthy life expectancy'])
        const xScale3_Health = d3.scaleLinear().domain(HealthExtent).range([0, chartHeight])

        const FreedomExtent = d3.extent(data, d => d['Explained by: Freedom to make life choices'])
        const xScale4_Freedom = d3.scaleLinear().domain(FreedomExtent).range([0, chartHeight])

        const GenerosityExtent = d3.extent(data, d => d['Explained by: Generosity'])
        const xScale5_Generosity = d3.scaleLinear().domain(GenerosityExtent).range([0, chartHeight])

        const CorruptionExtent = d3.extent(data, d => d['Explained by: Perceptions of corruption'])
        const xScale6_Corruption = d3.scaleLinear().domain(CorruptionExtent).range([0, chartHeight])

        
        const happinessExtent = d3.extent(data, d => d['Happiness score'])
        const yScale_happiness = d3.scaleLinear().domain(happinessExtent).range([chartWidth, 0])     
        
        

        // adding circle (data) 
        data.forEach( (d, i) => {
            // console.log(d, i)
            chartArea1.append('circle')
                     .attr('cx', xScale1_GDP(d['Explained by: GDP per capita']))
                     .attr('cy', yScale_happiness(d['Happiness score']))
                     .attr('r', '6')
                    //  .attr('opacity', 0.6)
                     .attr('index', i)  // I usually include the index as an extra attr so that if points look weird, I can find out what's going on in the dataset
                     .style('fill', '#a8e6cf');
        })
        data.forEach( (d, i) => {
            // console.log(d, i)
            chartArea2.append('circle')
                     .attr('cx', xScale2_SocialSupport(d['Explained by: Social support']))
                     .attr('cy', yScale_happiness(d['Happiness score']))
                     .attr('r', '6')
                    //  .attr('opacity', 0.6)
                     .attr('index', i)  // I usually include the index as an extra attr so that if points look weird, I can find out what's going on in the dataset
                     .style('fill', '#dcedc1');
        })
        data.forEach( (d, i) => {
            // console.log(d, i)
            chartArea3.append('circle')
                     .attr('cx', xScale3_Health(d['Explained by: Healthy life expectancy']))
                     .attr('cy', yScale_happiness(d['Happiness score']))
                     .attr('r', '6')
                    //  .attr('opacity', 0.6)
                     .attr('index', i)  // I usually include the index as an extra attr so that if points look weird, I can find out what's going on in the dataset
                     .style('fill', '#ffd3b6');
        })
        data.forEach( (d, i) => {
            // console.log(d, i)
            chartArea4.append('circle')
                     .attr('cx', xScale4_Freedom(d['Explained by: Freedom to make life choices']))
                     .attr('cy', yScale_happiness(d['Happiness score']))
                     .attr('r', '6')
                    //  .attr('opacity', 0.6)
                     .attr('index', i)  // I usually include the index as an extra attr so that if points look weird, I can find out what's going on in the dataset
                     .style('fill', '#ffaaa5');
        })
        data.forEach( (d, i) => {
            // console.log(d, i)
            chartArea5.append('circle')
                     .attr('cx', xScale5_Generosity(d['Explained by: Generosity']))
                     .attr('cy', yScale_happiness(d['Happiness score']))
                     .attr('r', '6')
                    //  .attr('opacity', 0.6)
                     .attr('index', i)  // I usually include the index as an extra attr so that if points look weird, I can find out what's going on in the dataset
                     .style('fill', '#ff8b94');
        })
        data.forEach( (d, i) => {
            // console.log(d, i)
            chartArea6.append('circle')
                     .attr('cx', xScale6_Corruption(d['Explained by: Perceptions of corruption']))
                     .attr('cy', yScale_happiness(d['Happiness score']))
                     .attr('r', '6')
                    //  .attr('opacity', 0.6)
                     .attr('index', i)  // I usually include the index as an extra attr so that if points look weird, I can find out what's going on in the dataset
                     .style('fill', '#ffe1a8');
        })
        
        // adding title, x, y label
        svg1.append("text")
            .attr("x", (width / 2))             
            .attr("y", 0 + (margins.top * 2))
            .attr("text-anchor", "middle")  
            .style("font-size", "24px") 
            .style("text-decoration", "underline")  
            .text("Happiness & GDP");

        svg1.append("text")
           .attr("class", "x label")
           .attr("text-anchor", "end")
           .attr("x", width)
           .attr("y", height - 6)
           .text("GDP");
           
        svg2.append("text")
            .attr("x", (width / 2))             
            .attr("y", 0 + (margins.top * 2))
            .attr("text-anchor", "middle")  
            .style("font-size", "24px") 
            .style("text-decoration", "underline")  
            .text("Happiness & Social support");

        svg2.append("text")
           .attr("class", "x label")
           .attr("text-anchor", "end")
           .attr("x", width)
           .attr("y", height - 6)
           .text("Social support");
           
        svg3.append("text")
            .attr("x", (width / 2))             
            .attr("y", 0 + (margins.top * 2))
            .attr("text-anchor", "middle")  
            .style("font-size", "24px") 
            .style("text-decoration", "underline")  
            .text("Happiness & Healthy Life Expectancy");

        svg3.append("text")
           .attr("class", "x label")
           .attr("text-anchor", "end")
           .attr("x", width)
           .attr("y", height - 6)
           .text("Healthy Life Expectancy");

              
        svg4.append("text")
            .attr("x", (width / 2))             
            .attr("y", 0 + (margins.top * 2))
            .attr("text-anchor", "middle")  
            .style("font-size", "24px") 
            .style("text-decoration", "underline")  
            .text("Happiness & Freedom");

        svg4.append("text")
           .attr("class", "x label")
           .attr("text-anchor", "end")
           .attr("x", width)
           .attr("y", height - 6)
           .text("Freedom");

              
        svg5.append("text")
            .attr("x", (width / 2))             
            .attr("y", 0 + (margins.top * 2))
            .attr("text-anchor", "middle")  
            .style("font-size", "24px") 
            .style("text-decoration", "underline")  
            .text("Happiness & Generosity");

        svg5.append("text")
           .attr("class", "x label")
           .attr("text-anchor", "end")
           .attr("x", width)
           .attr("y", height - 6)
           .text("Generosity");

              
        svg6.append("text")
            .attr("x", (width / 2))             
            .attr("y", 0 + (margins.top * 2))
            .attr("text-anchor", "middle")  
            .style("font-size", "24px") 
            .style("text-decoration", "underline")  
            .text("Happiness & Corruption");

        svg6.append("text")
           .attr("class", "x label")
           .attr("text-anchor", "end")
           .attr("x", width)
           .attr("y", height - 6)
           .text("Corruption");


        // adding y label 
        svg.append("text")
           .attr("class", "y label")
           .attr("text-anchor", "end")
           .attr("dy", ".65em")
           .attr("transform", "rotate(-90)")
           .text("Happiness");

    

      

        // axes
        let leftAxis = d3.axisLeft(yScale_happiness)
        svg.append('g')
           .attr('class', 'y axis')
           .attr('transform',`translate(${margins.left-10},${margins.top})`) 
           .call(leftAxis);

        let bottomAxis1 = d3.axisBottom(xScale1_GDP).ticks(5)  // .ticks tells it how many ticks to draw
        let element1 = svg1.append('g')
                         .attr('class', 'y axis')
                         .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
                         .call(bottomAxis1);
        
        let bottomAxis2 = d3.axisBottom(xScale2_SocialSupport).ticks(5)  // .ticks tells it how many ticks to draw
        let element2 = svg2.append('g')
                         .attr('class', 'y axis')
                         .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
                         .call(bottomAxis2);
        
        let bottomAxis3 = d3.axisBottom(xScale3_Health).ticks(5)  // .ticks tells it how many ticks to draw
        let element3 = svg3.append('g')
                         .attr('class', 'y axis')
                         .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
                         .call(bottomAxis3);
        
        let bottomAxis4 = d3.axisBottom(xScale4_Freedom).ticks(5)  // .ticks tells it how many ticks to draw
        let element4 = svg4.append('g')
                         .attr('class', 'y axis')
                         .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
                         .call(bottomAxis4);
        
        let bottomAxis5 = d3.axisBottom(xScale5_Generosity).ticks(5)  // .ticks tells it how many ticks to draw
        let element5 = svg5.append('g')
                         .attr('class', 'y axis')
                         .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
                         .call(bottomAxis5);
        
        let bottomAxis6 = d3.axisBottom(xScale6_Corruption).ticks(5)  // .ticks tells it how many ticks to draw
        let element6 = svg6.append('g')
                         .attr('class', 'y axis')
                         .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
                         .call(bottomAxis6);
        
        

        // grid lines
        let leftGridlines = d3.axisLeft(yScale_happiness)
                              .tickSize(-chartWidth-10)
                              .tickFormat('');
        // Notice how we use a different class
        svg.append('g').attr('class', 'y gridlines') // See CSS at top of file
        .attr('transform',`translate(${margins.left-10},${margins.top})`)
        .call(leftGridlines);
        // Make sure to set a gridlines class so you can distinguish it from your axes when styling
        
        
        // The real benefit is that you can use the same configurations on your gridline axis that you used on your label axis. For example, we can put a tick number here
        let bottomGridlines1 = d3.axisBottom(xScale1_GDP)
                                .tickSize(-chartHeight-10)
                                .tickFormat('')
                                .ticks(5); // Borrowing from our axis labels

        svg1.append('g').attr('class', 'x gridlines') // See CSS at top of file
        .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
        .call(bottomGridlines1);
        
        let bottomGridlines2 = d3.axisBottom(xScale2_SocialSupport)
                                .tickSize(-chartHeight-10)
                                .tickFormat('')
                                .ticks(5); // Borrowing from our axis labels

        svg2.append('g').attr('class', 'x gridlines') // See CSS at top of file
        .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
        .call(bottomGridlines2);

        let bottomGridlines3 = d3.axisBottom(xScale3_Health)
                                .tickSize(-chartHeight-10)
                                .tickFormat('')
                                .ticks(5); // Borrowing from our axis labels

        svg3.append('g').attr('class', 'x gridlines') // See CSS at top of file
        .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
        .call(bottomGridlines3);

        let bottomGridlines4 = d3.axisBottom(xScale4_Freedom)
                                .tickSize(-chartHeight-10)
                                .tickFormat('')
                                .ticks(5); // Borrowing from our axis labels

        svg4.append('g').attr('class', 'x gridlines') // See CSS at top of file
        .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
        .call(bottomGridlines4);

        let bottomGridlines5 = d3.axisBottom(xScale5_Generosity)
                                .tickSize(-chartHeight-10)
                                .tickFormat('')
                                .ticks(5); // Borrowing from our axis labels

        svg5.append('g').attr('class', 'x gridlines') // See CSS at top of file
        .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
        .call(bottomGridlines5);

        let bottomGridlines6 = d3.axisBottom(xScale6_Corruption)
                                .tickSize(-chartHeight-10)
                                .tickFormat('')
                                .ticks(5); // Borrowing from our axis labels

        svg6.append('g').attr('class', 'x gridlines') // See CSS at top of file
        .attr('transform',`translate(${margins.left},${chartHeight+margins.top+10})`)
        .call(bottomGridlines6);
        // 聖這邊
        });
    </script>
    <br> 
</body>
